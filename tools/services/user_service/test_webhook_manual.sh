#!/bin/bash

echo "ğŸ§ª æ‰‹åŠ¨æµ‹è¯• Stripe Webhook"
echo "=========================="

echo "ğŸ“‹ ä½¿ç”¨è¿™ä¸ªæµç¨‹æµ‹è¯•webhookï¼š"
echo ""
echo "1. åœ¨ä¸€ä¸ªç»ˆç«¯çª—å£è¿è¡Œï¼š"
echo "   stripe listen --forward-to localhost:8100/api/v1/webhooks/stripe"
echo ""
echo "2. å¤åˆ¶æ˜¾ç¤ºçš„ webhook signing secret åˆ° deployment/dev/.env.user_service"
echo ""
echo "3. åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£è¿è¡Œä»¥ä¸‹å‘½ä»¤è§¦å‘äº‹ä»¶ï¼š"
echo ""
echo "ğŸ¯ æµ‹è¯•è®¢é˜…å®Œæˆäº‹ä»¶ï¼š"
echo "stripe trigger checkout.session.completed"
echo ""
echo "ğŸ¯ æµ‹è¯•è®¢é˜…æ›´æ–°äº‹ä»¶ï¼š"
echo "stripe trigger customer.subscription.updated" 
echo ""
echo "ğŸ¯ æµ‹è¯•æ”¯ä»˜æˆåŠŸäº‹ä»¶ï¼š"
echo "stripe trigger invoice.payment_succeeded"
echo ""
echo "ğŸ“‹ æ£€æŸ¥ç»“æœï¼š"
echo "â€¢ æŸ¥çœ‹Stripe CLIè¾“å‡ºçš„äº‹ä»¶è½¬å‘æ—¥å¿—"
echo "â€¢ æŸ¥çœ‹åç«¯æœåŠ¡æ—¥å¿—: tail -f logs/user_service.log"
echo "â€¢ æ£€æŸ¥ç”¨æˆ·çŠ¶æ€æ˜¯å¦ä» 'free' æ›´æ–°ä¸º 'pro'"
echo ""
echo "ğŸ”§ å½“å‰é…ç½®ï¼š"
echo "â€¢ Webhook URL: localhost:8100/api/v1/webhooks/stripe"
echo "â€¢ Webhook Secret: $(grep STRIPE_WEBHOOK_SECRET deployment/dev/.env.user_service | cut -d'=' -f2)"
echo "â€¢ ç›®æ ‡ç”¨æˆ·: google-oauth2|107896640181181053492"